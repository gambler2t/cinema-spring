<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Регистрация</title>
    <link rel="stylesheet" th:href="@{/css/styles.css}">
</head>
<body>

<header class="topbar">
    <div class="brand">
        <a th:href="@{/}">Cinema</a>
    </div>
    <nav>
        <a th:href="@{/movies}">Movies</a>
        <a th:href="@{/about}">О кинотеатре</a>

        <span th:if="${#authorization.expression('hasRole(''USER''))}">
            <a th:href="@{/user/profile}">Профиль</a>
        </span>

        <span th:if="${#authorization.expression('hasRole(''ADMIN''))}">
            <a th:href="@{/admin/movies}">Admin</a>
        </span>
    </nav>
    <div class="auth">
        <a th:if="${#authorization.expression('isAnonymous()')}"
           th:href="@{/login}">Login</a>

        <span th:if="${#authorization.expression('isAuthenticated()')}">
            <span th:text="${#authentication.name}">user</span>
            <form th:action="@{/logout}" method="post" class="inline">
                <button type="submit" class="link-button">Logout</button>
            </form>
        </span>
    </div>
</header>

<main class="auth-page">
    <section class="auth-card">
        <h1 class="auth-title">Регистрация</h1>
        <p class="auth-subtitle">
            Создайте аккаунт, чтобы бронировать билеты, добавлять фильмы в избранное и вести историю посещений.
        </p>

        <!-- Общее сообщение об ошибках (если в контроллере что-то кладёшь в model.addAttribute("error", ...)) -->
        <p class="form-error" th:if="${error}" th:text="${error}"></p>
        <p class="form-error" th:if="${#fields.hasErrors('*')}">
            Проверьте правильность заполнения полей.
        </p>

        <!-- Важно: здесь предполагается, что в контроллере модель называется "registrationForm" -->
        <form th:action="@{/register}" th:object="${registrationForm}" method="post">
            <div class="form-group">
                <label for="username">Имя пользователя</label>
                <input id="username" type="text" th:field="*{username}" required>
            </div>

            <div class="form-group">
                <label for="fullName">Полное имя</label>
                <input id="fullName" type="text" th:field="*{fullName}">
            </div>

            <div class="form-group">
                <label for="email">Email</label>
                <input id="email" type="email" th:field="*{email}">
            </div>

            <div class="form-group">
                <label for="password">Пароль</label>
                <input id="password" type="password" th:field="*{password}" required>
            </div>

            <div class="form-group">
                <label for="confirmPassword">Повторите пароль</label>
                <input id="confirmPassword" type="password" th:field="*{confirmPassword}" required>
            </div>

            <div class="auth-actions">
                <button type="submit" class="btn btn-primary btn-full">
                    Зарегистрироваться
                </button>
            </div>
        </form>

        <div class="auth-secondary" style="margin-top: 12px;">
            Уже есть аккаунт?
            <a th:href="@{/login}">Войти</a>
        </div>
    </section>
</main>

</body>
</html>
